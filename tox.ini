[tox]
envlist =
    py{310,39,38}-djdev,
    py{310,39,38}-dj{40,41},
    py{310,39,38,37,36}-dj32,
    py{39,38,37,36}-dj{30,31},
    py{38,37,36,35}-dj{20,21,22},
    py27-flake8,
skipsdist=True

[testenv]
test-executable = 
    python --version
    python -c "import django; print(django.get_version())"
    pip install -r requirements_test.txt
    {envbindir}/python -Wall {envbindir}/coverage run --append --source=django_admin_smoke_tests
commands =
    {[testenv]test-executable} setup.py test
basepython =
    py27: python2.7
    py34: python3.4
    py35: python3.5
    py36: python3.6
    py37: python3.7
    py38: python3.8
    py39: python3.9
    py310: python3.10
deps =
    dj20: django==2.0.*
    dj21: django==2.1.*
    dj22: django==2.2.*
    dj30: django==3.0.*
    dj31: django==3.1.*
    dj32: django==3.2.*
    dj40: django==4.0.*
    dj41: django==4.1.*
    djdev: https://github.com/django/django/archive/master.tar.gz
    coverage
    ipdb
    pytz
    -rrequirements_test.txt

[testenv:py27-flake8]
deps =
    flake8
    flake8-import-order
commands =
    {envbindir}/flake8 --ignore=E128 --max-complexity 10 .
